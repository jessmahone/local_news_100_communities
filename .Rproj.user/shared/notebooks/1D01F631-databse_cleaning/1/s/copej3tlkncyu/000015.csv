"0",""
"0","# Change column names"
"0","colnames(communities) <- c(""state"", ""city"", ""geographic_area"", ""id_number"", ""population"", ""area_sqm"", ""density_pop_per_sqm"", ""geo_id2"", ""dollar"", ""closest_large_media_market"", ""distance_from_lmm"", ""pct_white"", ""pct_black"", ""pct_hislat"", ""universities_count"", ""county_seat"", ""state_capital"")"
"0",""
"0","# Assign community_id and clean up structure"
"0","communities <- communities %>%"
"0","  mutate(community_id = row_number()) %>%"
"0","  select(community_id, everything()) %>%"
"0","  mutate(across(c(county_seat, state_capital), ~replace_na(., 0))) %>%"
"0","  select(-c(geo_id2, dollar))  # drop ambiguous column"
"0",""
"0","# Standardize city names"
"0","communities <- communities %>%"
"0","  mutate(city = city %>%"
"0","           str_to_lower() %>%"
"0","           str_trim() %>%"
"0","           str_remove_all("" (city|village|town|municipality|boro|borough|cdp)$"") %>%"
"0","           str_to_title())"
"0",""
"0","# Clean state names and match abbreviations"
"0","state_lookup <- tibble("
"0","  state = str_to_title(state.name),"
"0","  abbreviation = state.abb"
"0",")"
"0",""
"0","communities <- communities %>%"
"0","  mutate(state = str_trim(state) %>% str_remove("" -$"")) %>%"
"0","  left_join(state_lookup, by = ""state"") %>%"
"0","  mutate(city = paste0(city, "", "", abbreviation)) %>%"
"0","  select(-c(state, geographic_area)) %>%"
"0","  rename(state = abbreviation)"
"0",""
"0",""
